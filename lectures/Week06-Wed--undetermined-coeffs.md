---
author: George McNinch
title: |
  Math 51 Spring 2022 - Week 5 Wed \
  Non-homogeneous linear equations -- undetermined coefficients 
date: 2022-02-16
bibliography:
 - /home/george/Prof-Math/assets/math-bibliography.bib
 - /home/george/Prof-Math/assets/teaching.bib 
csl: assets/chicago-author-date.csl
header-includes: |
  \usepackage[top=25mm,bottom=25mm,left=25mm,right=25mm]{geometry}
  \usepackage{palatino,mathpazo}
---

This lecture covers material from [@gutermanNitecki, sec. 2.7].

# Non-homogeneous linear equations: undetermined coefficients 

## Recall

::: incremental

- We want to solve linear ODEs of the form $$(\clubsuit) \quad P(D) x = E(t)$$

- to do so, we first find the general solution $H(t)$ to the homog. equation 
  $$P(D)x = 0$$
  
- and then we need a *particular* solution $q(t)$ to $P(D)x =
  E(t)$. Use of the term *particular solution* is meant to emphasize
  that we need only *one* such solution.
:::

------------

::: incremental

- now the general solution to $(\clubsuit) \quad P(D) x = E(t)$ is given by
  $$x(t) = q(t) + H(t).$$

- we've seen in previous sections how to solve the *homogeneous*
  equation $P(D)x = 0$ -- i.e. how to find $H(t)$.

- now we need techniques for find $q(t)$. 

- we are going to learn two: 
  - *method of undetermined coefficients* (in this lecture), and 
  - *variation of parameters* (in the next lecture)

:::

## Carrying out the method

::: incremental

- consider $(\heartsuit) \quad P(D)x = E(t)$

- we *find/choose* a linear differential operator $A(D)$ for which
  $A(D)[E(t)] = 0$.
  
- $A(D)$ is often called an *annihilator* because it "makes $E(t)$ become zero".  
  
- to find $A(D)$  we must recognize (if possible!!) $E(t)$ as a solution to an ODE
  $A(D)x = 0$ *for a suitable $A(D)$.*

:::

-----

Having chosen $A(D)$ for which $A(D)[E(t)] = 0$

::: incremental

- we now notice that any function which is a solution to $P(D)x =
  E(t)$ is also a solution to the homog. equation $A(D)P(D)x = 0$.
  
- indeed, if $P(D)[q(t)] = E(t)$ then
  $$A(D)P(D)[q(t)] = A(D)[E(t)] = 0.$$

- now, *we describe the general solution* to the "auxiliary"
  homogeneous equation $A(D)P(D) x = 0$ and treat it as a *guess* for
  the desired solution $q(t)$ for $(\heartsuit)$.

:::

## first example

::: incremental

- consider $(\clubsuit) \quad (D^2 - 2D -3)x = 1 + e^{-2t}$.

- since $1$ is a solution to $Dx = 0$ and $e^{-2t}$ is a solution to
  $(D+2)x = 0$, we see that $1 + e^{-2t}$ is a solution to $$D(D+2)x = 0.$$

- i.e $A(D) = D(D+2)$ has the property that $A(D)[1 + e^{-2t}] =
  0$.

- now the homog equation 

  \begin{align*}
  0 & = A(D)(D^2 - 2D - 3)x \\
  & = D(D+2)(D^2 -2D -3)x \\
  & = D(D+2)(D-3)(D+1)x
  \end{align*}
  
  has general solution generated by $1, e^{-2t}, e^{3t}, e^{-t}$.
  

:::

------

::: incremental

- so we are going to look for a solution $q(t)$ to $(\clubsuit)$ from among the functions
  $$k_1 +  k_2e^{-2t} + k_3 e^{3t} + k_4 e^{-t}$$


- Observe that $(D^2 - 2D -3)[k_3 e^{3t} + k_4 e^{-t}] =
  (D-3)(D+1)[k_3 e^{3t} + k_4 e^{-t}]= 0$.

- thus 
  $$(D^2 - 2D - 3)[k_1 +  k_2e^{-2t} + k_3 e^{3t} + k_4 e^{-t}] = 
  (D^2 - 2D - 3)[k_1 +  k_2e^{-2t}]$$

- since we are trying to solve the equation $(\clubsuit) \quad (D^2 - 2D - 3)x = 1 +
  e^{-2t}$, we may as well take $k_3 = k_4 = 0$.
  
- thus, we look for a particular solution of the form $q(t) = k_1 + k_2e^{-2t}$


:::

------

::: incremental


- *goal*:  find  coefficients $k_1,k_2$ such that

  $q(t) = k_1 + k_2e^{-2t}$ is a solution to $(\clubsuit)$.


- we need to arrange the following:
  $$(D^2 - 2D -3)[k_1 + k_2e^{-2t}] = 1 + e^{-2t}.$$
  
- we calculate 
  \begin{align*}
  & (D^2 -2D -3)[k_1 + k_2e^{-2t}] \\
  =& k_1(D^2 -2D -3)[1] + k_2(D^2 -2D -3)[e^{-2t}]\\
  \end{align*}
  by linearity. Now using the exponenential shift formula, find that
  
  \begin{align*}
  =& -3k_1 + k_2e^{-2t}((D-2)^2
  -2(D-2) -3)[1]  \\
  =& -3k_1 + k_2e^{-2t}(D^2 - 4D + 4 -2D +4 -3)[1] &  \\  
  =& -3k_1 + k_2e^{-2t}(D^2 - 6D + 5)[1] &  \\    
  =& -3k_1 + 5k_2e^{-2t} &
  \end{align*}
  
:::

-------------

::: incremental

- since $P(D)[q(t)] = (D^2 -2D -3)[k_1 + k_2e^{-2t}] = -3k_1 + 5k_2e^{-2t}$

  we need to solve solve for $k_1,k_2$ in the equality $-3k_1 + 5k_2e^{-2t} = 1 + e^{-2t}$.

- do this by *comparing coefficients*: 
  $$-3k_1 = 1 \quad , \quad  5k_2 = 1 \quad \implies \quad k_1 = -1/3 \quad , \quad k_2 = 1/5.$$


- thus a particular solution to $$(\clubsuit) \quad (D^2 - 2D -3)x =
  1 + e^{-2t}$$ is $$q(t) = \dfrac{-1}{3} + \dfrac{1}{5}e^{-2t}$$

- and the general solution to $(\clubsuit)$ is then
  $$x(t) =q(t) + H(t) = \dfrac{-1}{3} + \dfrac{1}{5}e^{-2t} + c_1 e^{3t} + c_2 e^{-t}.$$

:::

-----

## Remarks 

::: incremental

- Notice that we made an original guess for $q(t)$ by
  looking at solutions to $A(D)P(D)x =0$ -- in the previous example,
  that led to the "guess" $$q(t) = k_1 + k_2e^{-2t} + k_3 e^{3t} + k_4
  e^{-t}$$

- from this guess we *eliminated* solutions to the homogeneous
  equation $P(D)x = 0$ corresponding to the original equation
  $(\clubsuit) P(D)x = E(t)$.  In the previous example, we eliminated
  the solutions $e^{3t}$ and $e^{-t}$ (i.e. we set $k_3=k_4=0$).
  
  This led to the *simplified guess*
  $$q(t) = k_1 + k_2e^{-2t}$$

- we then solved for $k_1$ and $k_2$ by applying $P(D)$ to this
  simplified guess and comparing with $E(t)$.

:::

-----

- notice that in this case the *form* of the *simplified guess* for the
  particular solution "looks like" $E(t)$. 
  
  $$q(t) = k_1 + k_2e^{-2t}$$
  
  $$E(t) = 1 + e^{-2t}.$$
  
  That doesn't *always* happen, as the next example shows.


## Second example

::: incremental

- give a *simplified guess* for a particular solution to the inhomogeneous ODE
  $$(\diamondsuit) \quad (D^3 -2D^2 + 2D)x = e^t\sin(t)$$

- note that $e^t\sin(t)$ is a solution to a homog linear ODE
  whose char poly has root $1 + i$.
  
- and recall that $a + bi$ is a root of the polynomial $r^2 -2a r + (a^2 + b^2)$.
  
- Thus $1+i$ is a root of $r^2 -2r + 2$  

- conclude: the smallest operator $A(D)$ for which $A(D)[e^t\sin(t)] =
  0$ is $$A(D) = D^2 -2D + 2.$$



:::

----

::: incremental

- so a particular solution of $(\diamondsuit)$ is also a solution to
  the homogeneous equation

  $$0 = A(D)(D^3 - 2D^2 + 2D)[x]$$ 
  
  i.e.

  \begin{align*}
  (D^2-2D + 2)(D^3 -2D^2 + 2D)[x] 
  &= (D^2-2D + 2)(D^2-2D + 2)D[x] \\
  &= (D^2-2D + 2)^2D[x]
  \end{align*}


- the general solution to the auxiliary homog equation \
  $$(D^2-2D + 2)^2D[x] = 0$$
  is generated by
  $$1, \quad e^t\cos(t), \quad e^t\sin(t), \quad te^t\cos(t), \quad te^t\sin(t).$$


:::

----

::: incremental

- and a simplified guess for the required particular solution to
  $(\diamondsuit)$ is obtained by ruling out the solutions from this list
  
  $$1, \quad e^t\cos(t), \quad e^t\sin(t), \quad te^t\cos(t), \quad te^t\sin(t).$$
  
  which are already solutions to $(D^3 - 2D^2 + 2D)x=0$ -- i.e by eliminating
  $$1, \quad e^t\cos(t), \quad e^t\sin(t).$$
  
- thus a simplified guess for a particular solution to
  $(\diamondsuit)$ is $$q(t) = k_1 te^t\cos(t) + k_2 te^t\sin(t).$$

- note that this simplified guess doesn't "match" the form of $E(t) = e^t \sin(t)$.


:::

## Comparing coefficients

::: incremental

- Suppose that $f_1(t), f_2(t), f_3(t)$ are linearly independent
  functions. For scalars $k_i$ and $\ell_i$, suppose that
  $$k_1 f_1(t) + k_2 f_2(t) + k_3 f_3(t) = \ell_1 f_1(t) + \ell_2 f_2(t) + \ell_3 f_3(t).$$

- subtracting the right-hand-side, we find that
  \begin{align*}
  0 &= (k_1 f_1(t) + k_2 f_2(t) + k_3 f_3(t)) - (\ell_1 f_1(t) + \ell_2 f_2(t) + \ell_3 f_3(t)) \\
  &= (k_1 - \ell_1)f_1(t) + (k_2 -\ell_2)f_2(t) + (k_3 -\ell_3)f_3(t)
  \end{align*}
  and then linear independence of the $f_i(t)$ shows that
  $$k_1 = \ell_1, \quad k_2 = \ell_2 , \quad k_3 = \ell_3.$$
  
:::

----

## Third example

::: incremental

- consider $(\diamondsuit) \quad (D^2 + 1)x = e^{-t} + \sin(t) - 2\cos(t)$

- $A(D) = (D+1)(D^2 + 1)$

- auxiliary homogeneous equation: $(D+1)(D^2+1)(D^2+1)x = (D+1)(D^2+1)^2x = 0$.

- unsimplified guess for particular solution
  $$q(t) = k_1 e^{-t} + k_2 \sin(t) + k_3 \cos(t) + k_4 t\sin(t) + k_4 t\cos(t).$$

- simplified guess
  $$q(t) = \ell_1 e^{-t} + \ell_2 t\sin(2t) + \ell_3 t\cos(2t).$$

:::

-----

::: incremental

- next *compute* $P(D)[q(t)]$.
  \begin{align*}
  & (D^2+1)[\ell_1 e^{-t} + \ell_2 t\sin(t) + \ell_3 t\cos(t)] \\ 
  = &
  \ell_1(D^2+1)[e^{-t}] + \ell_2 (D^2+1)[ t\sin(t)] + \ell_3 (D^2+1)[t\cos(t)] \quad  (\clubsuit)
  \end{align*}
  
- We pause to compute 
  \begin{align*}
  (D^2+1)[t\sin(t)] &= t\sin(t) +  D[\sin(t) + t\cos(t)] \\
  &= t\sin(t) + \cos(t) + \cos(t) - t\sin(t) \\
  &= 2\cos(t)
  \end{align*}
  
- and
  \begin{align*}
  (D^2+1)[t\cos(t)] &= t\cos(t) +  D[\cos(t) - t\sin(t)] \\
  &= t\cos(t) - \sin(t) - \sin(t) - t\cos(t)\\
  &= -2\sin(t)
  \end{align*}
  
- Using these computations and $(\clubsuit)$ we find that
  $$P(D)[q(t)] = 2\ell_1 e^{-t} + 2\ell_2 \cos(t)  - 2 \ell_3 \sin(t).$$
:::

----

::: incremental

- now we need $P(D)[q(t)] = e^{-t} + \sin(t) - 2\cos(t) \quad (\diamondsuit).$

- i.e. we need
  $$2\ell_1 e^{-t} + 2\ell_2 \cos(t)  - 2 \ell_3 \sin(t) 
  = e^{-t} + \sin(t) - 2\cos(t)$$
  
- since $e^{-t}$, $\sin(t)$ and $\cos(t)$ are linearly independent
  functions, we can equate coefficients.
  
- we get
  $$2\ell_1 = 1, \quad 2\ell_2 = 1, \quad -2\ell_3 = -2
  \implies \ell_1 = 1/2, \quad \ell_2 = 1/2, \quad \ell_3 = 1$$

- thus a particular solution is 
  $$q(t) = \ell_1 e^{-t} + \ell_2 t\sin(t) + \ell_3 t\cos(t) = \dfrac{e^{-t}}{2}
  + \dfrac{t\sin(t)}{2} + t\cos(t).$$

:::


## Bibliography {.unnumbered}

::: {.refs}
:::
